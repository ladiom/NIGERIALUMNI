<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Test - Nigeria Alumni Network</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 2rem 0;
            padding: 1.5rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
        }
        .test-button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0.5rem;
        }
        .test-button:hover {
            background: #3182ce;
        }
        .result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 6px;
            font-family: monospace;
        }
        .success {
            background: #f0fff4;
            border: 1px solid #48bb78;
            color: #2d3748;
        }
        .error {
            background: #fff5f5;
            border: 1px solid #e53e3e;
            color: #c53030;
        }
        .info {
            background: #f7fafc;
            border: 1px solid #4299e1;
            color: #2d3748;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Email Service Test</h1>
        <p>Test the email functionality for the Nigeria Alumni Network platform.</p>

        <div class="test-section">
            <h3>üìß Test Approval Email</h3>
            <p>Test sending an approval email to a test recipient.</p>
            <button class="test-button" onclick="testApprovalEmail()">Send Test Approval Email</button>
            <div id="approval-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üìß Test Rejection Email</h3>
            <p>Test sending a rejection email to a test recipient.</p>
            <button class="test-button" onclick="testRejectionEmail()">Send Test Rejection Email</button>
            <div id="rejection-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üîß Test Email API Directly</h3>
            <p>Test the Netlify function directly without going through the React app.</p>
            <button class="test-button" onclick="testEmailAPI()">Test Email API</button>
            <div id="api-result" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        const SMTP_API_URL = 'https://nigeriaalumninetwork.netlify.app/.netlify/functions/send-email';

        async function testApprovalEmail() {
            const resultDiv = document.getElementById('approval-result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'Sending approval email...';

            try {
                const response = await fetch(SMTP_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        toEmail: 'test@example.com',
                        toName: 'Test User',
                        subject: 'üéâ Nigeria Alumni Network ‚Äî Registration Approved!',
                        body: `
                            <h1>Test Approval Email</h1>
                            <p>Congratulations! Your registration has been approved.</p>
                            <p>This is a test email from the Nigeria Alumni Network platform.</p>
                        `,
                        type: 'registration_approved'
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Approval Email Sent Successfully!</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        <strong>‚ùå Approval Email Failed</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <strong>‚ùå Error Sending Approval Email</strong><br>
                    <pre>${error.message}</pre>
                `;
            }
        }

        async function testRejectionEmail() {
            const resultDiv = document.getElementById('rejection-result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'Sending rejection email...';

            try {
                const response = await fetch(SMTP_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        toEmail: 'test@example.com',
                        toName: 'Test User',
                        subject: 'üìã Nigeria Alumni Network ‚Äî Registration Update',
                        body: `
                            <h1>Test Rejection Email</h1>
                            <p>We were unable to verify your registration information.</p>
                            <p>This is a test email from the Nigeria Alumni Network platform.</p>
                        `,
                        type: 'registration_rejected'
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Rejection Email Sent Successfully!</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        <strong>‚ùå Rejection Email Failed</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <strong>‚ùå Error Sending Rejection Email</strong><br>
                    <pre>${error.message}</pre>
                `;
            }
        }

        async function testEmailAPI() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'Testing email API...';

            try {
                const response = await fetch(SMTP_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        toEmail: 'admin@ladiom.com',
                        toName: 'Admin Test',
                        subject: 'üß™ API Test Email',
                        body: '<h1>API Test</h1><p>This is a direct API test from the browser.</p>',
                        type: 'test'
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Email API Working!</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        <strong>‚ùå Email API Failed</strong><br>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <strong>‚ùå Error Testing Email API</strong><br>
                    <pre>${error.message}</pre>
                `;
            }
        }
    </script>
</body>
</html>